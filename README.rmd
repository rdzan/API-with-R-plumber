---
title: "Plumber - hosting API"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
``` 

![](readme.gif)

## Hosting 
API uruchamia sie na porcie 7494 (patrz plik *runAPI.R*). W celu trwałego uruchomienia API na serwerze należy wywołać skrypt *runAPI.R*. Nie zrobimy tego poprzez wywołanie odpowiedniej komendy w terminalu gdyż po jego zamknięciu proces zostaje skillowany i API przestaje działać. W związku z tym wykorzystamy program [screen](https://askubuntu.com/questions/389834/how-to-run-application-from-terminal-forever). 

## Uruchomienie API - instrukcja 

```{bash eval = FALSE}
screen 
cd ~/myProject
Rscript runAPI.R
``` 

Nastepnie należy skorzystać ze skrótów klawiszowych *Ctrl+A* i *Ctrl+D* by zamknąć screen-a ale pozostawiając jego sesję aktywną. Poleceniem: 

```{bash eval = FALSE}
screen -ls 
``` 

zobaczymy wszystkie aktywne sesje screen-a. Aby spowrotem otworzyć daną sesję wpisujemy: 

```{bash eval = FALSE}
screen -r processId
``` 

gdzie *processId* to numer procesu obługującego daną sesję wypisany na początku nazw wylistowanych aktywnych sesji screena. Aby skillować sesję wywołujemy: 

```{bash eval = FALSE}
screen -XS processId quit
``` 

## Uwierzytelnienie 
W podanym przykładzie uwierzytelnienie jest zrobione po stronie API. Każda metoda zawiera parametr **userKey** będący kluczem uwierzytelniającym. Jeśli klucz pasuje do zapisanej w pliku *usersKey.txt* listy kluczy logujemy odpytanie i próbujemy je zrealizować, wpp zapytanie jest wstrzymane i zwracany jest error. 

## Example 
W celu testowania API wywołaj plik *functions/generateOrders.R* i postepuj zgodnie z dokumentacją API  [http://127.0.0.1:7494/__docs__/](http://127.0.0.1:7494/__docs__/). 
